def whid = 'ab33zr83489urf34r43j'
def device_id = 'DV0025LM33'

def energy =
    |modbus('hregs')
    .ip('127.0.0.1')
    .port(8899)
    .device(255)
    .every(1s)
    .from(2127)
    .count(5)
    .as('Energy.ActiveEnergyConsumption', 'Energy.MaximalCurrentValue',
        'Energy.BlindEnergyDelivered', 'Energy.Max.A', 'Energy.Min.A')

%% add some tags
    |default()
    .tags('name', 'warehouse_id', 'device_id')
    .tag_values('persistent_publisher', whid, device_id)

    %% rename some fields
    |rename()
    .fields('Energy.Max.A', 'Energy.Min.A')
    .as_fields('EMaxA')
    .tags('warehouse_id')
    .as_tags('whid')
